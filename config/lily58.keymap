/*
 * Allium58 keymap inspired by Glove80 (preferred) + Sweep (HRMs)
 * Build-safe: only core ZMK behaviors and valid key/behavior names.
 */

#include <behaviors.dtsi>
#include <dt-bindings/zmk/keys.h>
#include <dt-bindings/zmk/bt.h>
#include <dt-bindings/zmk/rgb.h>

/* ---------- Simple, build-safe behaviors ---------- */
&{/} {
    behaviors {
        /* Generic hold-tap for Home Row Mods (mirrors your Sweep feel) */
        ht: hold_tap {
            compatible = "zmk,behavior-hold-tap";
            #binding-cells = <2>;
            flavor = "balanced";
            tapping-term-ms = <250>;
            quick-tap-ms = <175>;
            require-prior-idle-ms = <125>;
            bindings = <&kp>, <&kp>;
        };
    };
};

/* Layer constants for clarity */
#define L_BASE 0
#define L_NAV  1
#define L_SYM  2
#define L_NUM  3
#define L_ADJ  4

/ {
    keymap {
        compatible = "zmk,keymap";

        /* ------------------ Layer 0: Base (QWERTY with Home Row Mods) ------------------ */
        default_layer {
            display-name = "Base";
            bindings = <
/* Row 1 (12) */  &kp ESC   &kp N1     &kp N2     &kp N3     &kp N4     &kp N5                       &kp N6     &kp N7     &kp N8     &kp N9     &kp N0      &kp GRAVE
/* Row 2 (12) */  &kp TAB   &kp Q      &kp W      &kp E      &kp R      &kp T                        &kp Y      &kp U      &kp I      &kp O      &kp P       &kp MINUS
/* Row 3 (12) */  &kp LCTRL &ht LGUI A &ht LALT S &ht LCTRL D &ht LSHFT F &kp G                       &kp H      &ht RSHFT J &ht RCTRL K &ht RALT L &kp SEMI    &ht RGUI SQT
/* Row 4 (14) */  &kp LSHFT &kp Z      &kp X      &kp C      &kp V      &kp B  &kp LBKT   &kp RBKT    &kp N      &kp M      &kp COMMA  &kp DOT    &kp FSLH    &kp RSHFT
/* Thumbs (8) */               &kp LALT &kp LGUI   &lt L_NAV TAB   &lt L_NUM SPACE     &lt L_SYM ENTER   &mo L_ADJ     &kp BSPC    &kp RGUI
            >;
        };

        /* ------------------ Layer 1: Nav / Editing ------------------ */
        nav_layer {
            display-name = "Nav";
            bindings = <
/* Row 1 (12) */  &kp PSCRN   &kp F1       &kp F2        &kp F3        &kp F10                      &kp INS        &kp HOME     &kp PG_DN   &kp PG_UP   &kp END     &kp INS      &trans
/* Row 2 (12) */  &kp TAB     &kp LC(Z)    &kp LC(X)     &kp LC(C)     &kp LC(V)                    &kp DEL        &kp LEFT     &kp DOWN    &kp UP      &kp RIGHT   &caps_word   &trans
/* Row 3 (12) */  &trans      &kp C_VOL_UP &kp C_MUTE    &kp C_VOL_DN  &kp K_APP                     &kp ESC        &kp HOME     &kp PG_DN   &kp PG_UP   &kp END     &kp DEL      &trans
/* Row 4 (14) */  &sk LSHFT   &sk LGUI     &sk LALT      &sk LCTRL      &sk LSHFT  &trans  &trans   &trans         &trans       &sk RSHFT    &sk RCTRL    &sk RALT    &sk RGUI     &sk RSHFT
/* Thumbs (8) */               &trans       &trans        &trans         &trans                       &trans         &trans        &trans       &trans
            >;
        };

        /* ------------------ Layer 2: Symbols ------------------ */
        sym_layer {
            display-name = "Symbols";
            bindings = <
/* Row 1 (12) */  &kp GRAVE  &kp TILDE  &kp HASH   &kp AMPS   &kp PIPE                      &kp CARET  &kp LBRC  &kp RBRC  &kp LBKT  &kp RBKT  &kp DOLLAR  &trans
/* Row 2 (12) */  &kp EXCL   &kp UNDER  &kp COLON  &kp EQUAL  &kp DOLLAR                    &kp AT     &kp LPAR  &kp RPAR  &kp UNDER &kp SEMI  &kp BSLH    &trans
/* Row 3 (12) */  &kp PRCNT  &kp QMARK  &kp STAR   &kp PLUS   &kp BSLH                       &kp FSLH   &kp MINUS &kp LT    &kp GT    &kp DQT   &kp SQT     &trans
/* Row 4 (14) */  &trans     &trans     &trans     &trans     &trans   &trans  &trans   &trans     &trans   &trans   &trans     &trans     &trans       &trans
/* Thumbs (8) */               &trans     &trans     &trans      &trans                        &trans      &trans      &trans      &trans
            >;
        };

        /* ------------------ Layer 3: Numbers / Numpad-ish ------------------ */
        num_layer {
            display-name = "Num";
            bindings = <
/* Row 1 (12) */  &kp C_BRI_DN &kp C_BRI_UP &kp C_PREV    &kp C_NEXT    &kp C_PP                   &kp C_MUTE &kp C_VOL_DN &kp C_VOL_UP &kp F11      &kp F12      &kp PAUSE_BREAK &trans
/* Row 2 (12) */  &kp GRAVE    &kp N1       &kp N2        &kp N3        &kp N4                      &kp N5     &kp N6       &kp N7       &kp N8       &kp N9       &kp N0           &kp MINUS
/* Row 3 (12) */  &trans       &kp KP_SLASH &kp KP_MULTIPLY &kp KP_MINUS &kp KP_PLUS                 &kp COMMA  &kp KP_N4    &kp KP_N5    &kp KP_N6    &kp KP_PLUS  &kp KP_ENTER     &trans
/* Row 4 (14) */  &trans       &kp KP_DOT   &kp KP_N1     &kp KP_N2     &kp KP_N3   &kp KP_N0  &trans   &trans    &trans       &trans       &trans        &trans        &trans          &trans
/* Thumbs (8) */               &trans       &trans        &trans         &trans                       &trans      &trans        &trans        &trans
            >;
        };

        /* ------------------ Layer 4: Adjust / Bluetooth / System ------------------ */
        adjust_layer {
            display-name = "Adjust";
            bindings = <
/* Row 1 (12) */  &sys_reset  &bt BT_CLR_ALL  &bt BT_SEL 0   &bt BT_SEL 1   &bt BT_SEL 2          &bt BT_SEL 3   &bt BT_SEL 4  &trans  &trans  &trans  &trans  &trans
/* Row 2 (12) */  &bootloader &kp F1          &kp F2         &kp F3         &kp F4                 &kp F5         &kp F6        &kp F7  &kp F8
